[README.md](https://github.com/user-attachments/files/24726201/README.md)
# AI Manuscript Reference Toolkit

![Python Version](https://img.shields.io/badge/python-3.x-blue) ![License](https://img.shields.io/badge/license-MIT-green)

A comprehensive Python toolkit designed to verify, correct, enrich, and format references in research manuscripts‚Äîspecifically those generated by AI tools (like Gemini, ChatGPT, or Claude).

It bridges the gap between **raw AI output** (which often contains hallucinations, incomplete metadata, or formatting errors) and a **finalized, academic Word document**.

## üåü Key Features

*   **Hallucination Detection:** Verifies every citation against **PubMed** and **Crossref**.
*   **PDF Rescue:** If a citation is generic (e.g., title="REVIEWS"), it scans the linked PDF to find the real DOI.
*   **Metadata Enrichment:** Automatically fills missing Volume, Issue, and Page numbers.
*   **Smart Formatting:** Converts `[1]` to `(Author, 2024)`, handles disambiguation `(2024a, 2024b)`, and updates tables.
*   **Retraction Watch:** Flags retracted papers immediately.
*   **Fuzzy Deduplication:** Detects that a "Preprint" and "Published" version are the same paper and merges them.

---

## ‚öôÔ∏è Configuration (Important)

To query PubMed efficiently without hitting rate limits, you should configure your credentials.

**Option A: Environment Variables (Recommended)**
This keeps your keys safe and out of the code.

*   **Mac/Linux:**
    ```bash
    export NCBI_EMAIL="your_email@example.com"
    export NCBI_API_KEY="your_api_key"
    ```
*   **Windows (CMD/PowerShell):**
    ```cmd
    set NCBI_EMAIL=your_email@example.com
    set NCBI_API_KEY=your_api_key
    ```

**Option B: Hardcoding**
You can edit the `Entrez.email` and `Entrez.api_key` lines directly in the scripts if you are not sharing them publicly.

---

## üì¶ Installation

Requires Python 3. Install the dependencies:

```bash
pip install bibtexparser python-docx biopython rapidfuzz pypdf requests
```

---

## üöÄ Workflow 1: The AI-to-Manuscript Pipeline

Use this workflow if you generated a reference list using AI and want to apply it to a manuscript.

### Step 1: Verify & Enrich
Takes a raw `.bib` file (generated by AI Studio/ChatGPT), validates it, and fills in missing data.
```bash
python verify_bib.py input.bib
```
*   **Output:** `input_verified.bib`

### Step 2: Diagnostic Check (Optional)
Converts the verified BibTeX into a human-readable text list. Useful for spot-checking duplicates or errors before modifying the document.
```bash
python generate_report.py input_verified.bib
```
*   **Output:** `input_verified_list.txt`

### Step 3: Apply to Manuscript
Updates citations in your Word Doc. Converts `[1]` $\to$ `(Author, 2023)` and appends a fully formatted bibliography.
```bash
python apply_citations.py input_verified.bib "MyManuscript.docx"
```
*   **Output:** `MyManuscript_final.docx`

---

## üîç Workflow 2: The Quick Audit

Use this if you have an **existing** Word document (written by a human or AI) and just want to check if the references are real.

### Scan Raw References
Scans a `.docx` or `.txt` file for PMIDs/DOIs, verifies them, and flags retractions. It does *not* require a BibTeX file.
```bash
python scan_raw_refs.py "Manuscript.docx"
```
*   **Output:** `Manuscript_verification_report.csv`

---

## üìÇ Script Details

| Script Name | Purpose | Key Capabilities |
| :--- | :--- | :--- |
| **`verify_bib.py`** | **The Engine** | ‚Ä¢ Dual-Database Search (PubMed + Crossref)<br>‚Ä¢ Extracts Vol/Issue/Pages<br>‚Ä¢ Scans PDF URLs for DOIs<br>‚Ä¢ Flags Retractions |
| **`apply_citations.py`** | **The Formatter** | ‚Ä¢ Updates Body Text & Tables<br>‚Ä¢ Disambiguation (`2023a`, `2023b`)<br>‚Ä¢ Merges Preprints with Published versions<br>‚Ä¢ Cell Press Style Bibliography |
| **`generate_report.py`** | **The Reporter** | ‚Ä¢ Generates numbered text lists<br>‚Ä¢ Sorts naturally (1, 2, 10)<br>‚Ä¢ Explicitly marks duplicates |
| **`scan_raw_refs.py`** | **The Auditor** | ‚Ä¢ Works on raw text/Word docs<br>‚Ä¢ No BibTeX required<br>‚Ä¢ Good for "Sanity Checks" |

---

## üóÇÔ∏è Managing Files via GitHub Website

If you need to delete or modify files in this repository using the GitHub web interface (without using Git locally), follow these steps:

### How to Delete a File (e.g., `placeholder.txt` in the scripts folder)

1. **Navigate to the File:**
   - Go to the repository on GitHub: `https://github.com/aimamoto/ref_management`
   - Click on the `scripts` folder
   - Click on the file you want to delete (e.g., `placeholder.txt`)

2. **Delete the File:**
   - Click the **trash can icon** (üóëÔ∏è) in the top-right corner of the file view
   - This will open a commit interface

3. **Commit the Deletion:**
   - Add a commit message describing the change (e.g., "Remove placeholder.txt")
   - Optionally, add an extended description
   - Choose to commit directly to the main branch or create a new branch for a pull request
   - Click **Commit changes**

### Other File Operations via GitHub Website

- **Edit a File:** Click the pencil icon (‚úèÔ∏è) when viewing the file
- **Upload Files:** Click "Add file" ‚Üí "Upload files" in the repository or folder view
- **Create New File:** Click "Add file" ‚Üí "Create new file" in the repository or folder view

---

## ‚öñÔ∏è License & Data Usage

**Code License:** [MIT License](LICENSE)

**Data Usage:**
This tool interacts with the [NCBI Entrez API](https://www.ncbi.nlm.nih.gov/home/about/policies/) (PubMed) and the [Crossref API](https://www.crossref.org/documentation/retrieve-metadata/). Users are responsible for adhering to the Terms of Service of these providers, particularly regarding rate limits and bulk data usage.
